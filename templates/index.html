<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Google Search Clone</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #searchResults { margin-top: 20px; }
        .result-item { margin-bottom: 15px; padding: 10px; border-bottom: 1px solid #ccc; }
        a { text-decoration: none; color: blue; }
        a:hover { text-decoration: underline; }
        .buttons { margin-top: 20px; }
    </style>
</head>
<body>

    <h2>Google Custom Search</h2>
    <input type="text" id="searchQuery" placeholder="Enter search term">
    <button onclick="performSearch(1)">Search</button>

    <div id="searchResults"></div>

    <div class="buttons">
        <button id="prevButton" onclick="prevPage()" disabled>Previous</button>
        <button id="nextButton" onclick="nextPage()" disabled>Next</button>
    </div>

    <script>
        let currentQuery = "";
        let currentStart = 1;
        let nextStart = null;

        function performSearch(start) {
            currentQuery = document.getElementById("searchQuery").value.trim();
            if (!currentQuery) {
                alert("Please enter a search term!");
                return;
            }

            fetch(`/search?q=${encodeURIComponent(currentQuery)}&start=${start}`)
                .then(response => response.json())
                .then(data => {
                    let resultsDiv = document.getElementById("searchResults");
                    resultsDiv.innerHTML = "";

                    if (!data.results.length) {
                        resultsDiv.innerHTML = "<p>No results found.</p>";
                        return;
                    }

                    data.results.forEach(item => {
                        let div = document.createElement("div");
                        div.className = "result-item";
                        div.innerHTML = `
                            <a href="${item.link}" target="_blank"><h4>${item.title}</h4></a>
                            <p>${item.snippet}</p>
                        `;
                        resultsDiv.appendChild(div);
                    });

                    // Update pagination
                    currentStart = start;
                    nextStart = data.next_start || null;
                    updatePaginationButtons();
                })
                .catch(error => console.error("Error fetching search results:", error));
        }

        function updatePaginationButtons() {
            console.log("[DEBUG]: updatePaginationButtons() used; ", currentStart,",", nextStart);
            document.getElementById("prevButton").disabled = currentStart <= 1;
            document.getElementById("nextButton").disabled = nextStart === null;
        }

        function nextPage() {
            console.log("[DEBUG]: nextPage() used; ", nextStart);
            if (nextStart) {
                performSearch(nextStart);
            }
        }

        function prevPage() {
            console.log("[DEBUG]: prevPage() used; ", currentStart);
            if (currentStart > 1) {
                performSearch(currentStart - 10);
            }
        }
    </script>

</body>
</html>
